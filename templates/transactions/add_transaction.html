{% extends 'base.html' %}

{% block title %}Add Transaction{% endblock %}

{% block content %}
<h2>Add Transaction</h2>
<form id="add-transaction-form">
    <select id="transaction_type">
        <option value="income">Income</option>
        <option value="expense">Expense</option>
    </select>
    <input type="number" id="amount" placeholder="Amount">
    <textarea id="description" placeholder="Description"></textarea>
    <input type="date" id="date">
    <button type="submit">Add Transaction</button>
</form>

<script>
    document.getElementById('add-transaction-form').addEventListener('submit', function(event) {
        event.preventDefault();

        const transactionType = document.getElementById('transaction_type').value;
        const amount = document.getElementById('amount').value;
        const description = document.getElementById('description').value;
        const date = document.getElementById('date').value;

        fetch('/api/transactions/', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Token ' + localStorage.getItem('token')
            },
            body: JSON.stringify({
                transaction_type: transactionType,
                amount: amount,
                description: description,
                date: date
            })
        })
        .then(response => response.json())
        .then(data => {
            if (data.id) {
                window.location.href = '/';
            } else {
                alert('Failed to add transaction');
            }
        });
    });
</script>
{% endblock %}
